<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Collateral Dilemma</title>
    <style>
        /* General Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 90%;
            max-width: 800px;
            margin: 50px auto;
            overflow: hidden;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
        }
        .scenario {
            margin-bottom: 20px;
        }
        .scenario h2 {
            margin-top: 0;
        }
        .options {
            margin-top: 20px;
        }
        .option-button {
            display: block;
            width: 100%;
            background: #007BFF;
            color: #fff;
            border: none;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
            text-align: left;
        }
        .option-button:hover {
            background: #0056b3;
        }
        .result {
            background: #dff0d8;
            color: #3c763d;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
        }
        .progress {
            text-align: right;
            margin-bottom: 10px;
            color: #555;
        }
        .stats {
            margin-top: 20px;
            font-size: 14px;
            color: #555;
        }
        .hidden {
            display: none;
        }
        .footer {
            text-align: center;
            padding: 10px;
            background: #222;
            color: #fff;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        /* Graphic Styles */
        .graphic {
            width: 100%;
            height: 300px;
            background: #eaeaea;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }
        .graphic svg {
            width: 100%;
            height: 100%;
        }
        .graphic .interactive {
            cursor: pointer;
        }
        .graphic text {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        /* Animation Styles */
        .fade-out {
            animation: fadeOut 1s forwards;
        }
        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }
        .explosion {
            animation: explode 0.5s steps(5) forwards;
            background-image: url('https://i.pinimg.com/736x/fc/78/11/fc7811ff756e44cee7234bfc412bca4e.jpg'); /* You need to provide an explosion sprite image */
            background-size: cover;
        }
        @keyframes explode {
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
        /* Speech Bubble */
        .speech-bubble {
            position: absolute;
            background: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            padding: 10px;
            font-size: 16px;
            display: none;
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            margin-left: -10px;
            border-width: 10px;
            border-style: solid;
            border-color: #000 transparent transparent transparent;
        }
    </style>
</head>
<body>

    <div class="container">
        <div id="game">
            <!-- Game content will be injected here -->
        </div>
    </div>

    <div class="footer">
        &copy; 2024 Collateral Dilemma
    </div>

    <script>
        const scenarios = [
            {
                id: 1,
                title: "Scenario 1: The Runaway Train",
                description: "A train is hurtling down a track towards a group of five workers who cannot hear it coming. You are next to a lever that can switch the train to another track where it will hit one worker instead.",
                options: [
                    { text: "Option A: Do nothing, and the train kills the five workers.", stats: { A: 0, B: 0 } },
                    { text: "Option B: Pull the lever, diverting the train to kill one worker.", stats: { A: 0, B: 0 } }
                ],
                graphic: function(selectedOption) {
                    return `
                        <svg viewBox="0 0 800 300">
                            <!-- Tracks -->
                            <line x1="100" y1="50" x2="700" y2="50" stroke="#888" stroke-width="4"/>
                            <line x1="100" y1="250" x2="700" y2="250" stroke="#888" stroke-width="4"/>
                            <!-- Diverging Track -->
                            <line x1="400" y1="50" x2="700" y2="250" stroke="#888" stroke-width="4"/>
                            <!-- Workers -->
                            <g id="workers">
                                <circle cx="650" cy="50" r="15" fill="blue"/>
                                <circle cx="670" cy="50" r="15" fill="blue"/>
                                <circle cx="690" cy="50" r="15" fill="blue"/>
                                <circle cx="710" cy="50" r="15" fill="blue"/>
                                <circle cx="730" cy="50" r="15" fill="blue"/>
                            </g>
                            <text x="650" y="30" font-size="14">5 Workers</text>
                            <g id="worker">
                                <circle cx="730" cy="250" r="15" fill="green"/>
                            </g>
                            <text x="730" y="280" font-size="14" text-anchor="middle">1 Worker</text>
                            <!-- Train -->
                            ${selectedOption === 1 ? `
                                <!-- Train diverted -->
                                <rect x="350" y="200" width="50" height="30" fill="red" id="train"/>
                                <animate xlink:href="#train" attributeName="x" from="350" to="680" dur="2s" fill="freeze"/>
                                <animate xlink:href="#train" attributeName="y" from="200" to="220" dur="2s" fill="freeze"/>
                            ` : `
                                <!-- Train continues straight -->
                                <rect x="350" y="20" width="50" height="30" fill="red" id="train"/>
                                <animate xlink:href="#train" attributeName="x" from="350" to="680" dur="2s" fill="freeze"/>
                            `}
                            <!-- Lever -->
                            <circle cx="100" cy="150" r="20" fill="#ccc" class="interactive" onclick="selectOption(1)"/>
                            <line x1="100" y1="150" x2="${selectedOption === 1 ? '140' : '100'}" y2="${selectedOption === 1 ? '110' : '100'}" stroke="black" stroke-width="4"/>
                            <text x="70" y="160" font-size="14">Lever</text>
                        </svg>
                    `;
                },
                animation: function(selectedOption) {
                    if (selectedOption === 0) {
                        // Option A: Train kills five workers
                        document.getElementById('workers').classList.add('fade-out');
                        showSpeechBubble(690, 20, 'Aaargh!');
                    } else {
                        // Option B: Train kills one worker
                        document.getElementById('worker').classList.add('fade-out');
                        showSpeechBubble(730, 230, 'Why me?!');
                    }
                }
            },
            {
                id: 2,
                title: "Scenario 2: The Hospital Organ Shortage",
                description: "Five patients need organ transplants to survive. A healthy traveler comes in for a routine check-up.",
                options: [
                    { text: "Option A: Do nothing, and the five patients die.", stats: { A: 0, B: 0 } },
                    { text: "Option B: Sacrifice the traveler to save the five patients.", stats: { A: 0, B: 0 } }
                ],
                graphic: function(selectedOption) {
                    return `
                        <svg viewBox="0 0 800 300">
                            <!-- Hospital Building -->
                            <rect x="50" y="50" width="700" height="200" fill="#eaeaea" stroke="#ccc"/>
                            <!-- Patients -->
                            <g id="patients">
                                <circle cx="200" cy="150" r="20" fill="blue"/>
                                <circle cx="300" cy="150" r="20" fill="blue"/>
                                <circle cx="400" cy="150" r="20" fill="blue"/>
                                <circle cx="500" cy="150" r="20" fill="blue"/>
                                <circle cx="600" cy="150" r="20" fill="blue"/>
                            </g>
                            <text x="400" y="100" font-size="16" text-anchor="middle">5 Patients</text>
                            <!-- Traveler -->
                            <g id="traveler">
                                <circle cx="700" cy="250" r="20" fill="green"/>
                            </g>
                            <text x="700" y="280" font-size="14" text-anchor="middle">Traveler</text>
                            ${selectedOption === 1 ? `
                                <!-- Traveler sacrificed -->
                                <line x1="700" y1="250" x2="700" y2="150" stroke="black" stroke-width="2"/>
                                <animate xlink:href="#traveler" attributeName="opacity" from="1" to="0" dur="1s" fill="freeze"/>
                            ` : `
                                <!-- No action -->
                            `}
                        </svg>
                    `;
                },
                animation: function(selectedOption) {
                    if (selectedOption === 1) {
                        // Option B: Sacrifice traveler
                        document.getElementById('traveler').classList.add('fade-out');
                        showSpeechBubble(700, 230, 'Wait, what?!');
                    } else {
                        // Option A: Patients die
                        document.getElementById('patients').classList.add('fade-out');
                        showSpeechBubble(400, 130, 'Goodbye...');
                    }
                }
            },
            {
                id: 3,
                title: "Scenario 3: The Bomb Threat",
                description: "A terrorist has planted a bomb in a crowded city area. You have captured him but he refuses to disclose the location.",
                options: [
                    { text: "Option A: Respect his rights and hope to find the bomb in time.", stats: { A: 0, B: 0 } },
                    { text: "Option B: Use harsh interrogation techniques to extract information, violating his rights.", stats: { A: 0, B: 0 } }
                ],
                graphic: function(selectedOption) {
                    return `
                        <svg viewBox="0 0 800 300">
                            <!-- Cityscape -->
                            <rect x="0" y="150" width="800" height="150" fill="#ccc"/>
                            <!-- Bomb -->
                            <g id="bomb">
                                <circle cx="400" cy="200" r="20" fill="red"/>
                                <text x="400" y="195" font-size="14" text-anchor="middle" fill="#fff">Bomb</text>
                            </g>
                            <!-- Terrorist -->
                            <circle cx="100" cy="250" r="20" fill="black"/>
                            <text x="100" y="280" font-size="14" text-anchor="middle">Suspect</text>
                            ${selectedOption === 1 ? `
                                <!-- Interrogation -->
                                <line x1="100" y1="250" x2="400" y2="200" stroke="black" stroke-width="2"/>
                                <animate xlink:href="#bomb" attributeName="opacity" from="1" to="0" dur="1s" fill="freeze"/>
                            ` : `
                                <!-- No action -->
                            `}
                        </svg>
                    `;
                },
                animation: function(selectedOption) {
                    if (selectedOption === 0) {
                        // Option A: Bomb explodes
                        document.getElementById('bomb').classList.add('explosion');
                    } else {
                        // Option B: Bomb defused
                        showSpeechBubble(400, 180, 'Bomb Defused!');
                    }
                }
            },
            {
                id: 4,
                title: "Scenario 4: The Drone Strike",
                description: "You have intel on a terrorist leader's location. A drone strike will eliminate the threat but also cause collateral damage, killing nearby civilians.",
                options: [
                    { text: "Option A: Authorize the strike to eliminate the terrorist.", stats: { A: 0, B: 0 } },
                    { text: "Option B: Abort the mission to avoid civilian casualties.", stats: { A: 0, B: 0 } }
                ],
                graphic: function(selectedOption) {
                    return `
                        <svg viewBox="0 0 800 300">
                            <!-- Buildings -->
                            <rect x="350" y="100" width="100" height="150" fill="#aaa" id="building"/>
                            <text x="400" y="90" font-size="14" text-anchor="middle">Target Building</text>
                            <!-- Drone -->
                            <polygon points="100,50 120,70 80,70" fill="#666" id="drone"/>
                            ${selectedOption === 0 ? `
                                <!-- Drone Strike -->
                                <animateMotion xlink:href="#drone" dur="2s" fill="freeze">
                                    <mpath xlink:href="#dronePath"/>
                                </animateMotion>
                                <path id="dronePath" d="M100,50 L400,150"/>
                                <animate xlink:href="#building" attributeName="opacity" from="1" to="0" begin="2s" dur="0.5s" fill="freeze"/>
                            ` : `
                                <!-- No action -->
                            `}
                        </svg>
                    `;
                },
                animation: function(selectedOption) {
                    if (selectedOption === 0) {
                        // Option A: Building destroyed
                        document.getElementById('building').classList.add('fade-out');
                        showSpeechBubble(400, 80, 'Boom!');
                    } else {
                        // Option B: Mission aborted
                        showSpeechBubble(100, 30, 'Mission Aborted');
                    }
                }
            },
            // Add more scenarios as needed...
        ];

        let currentScenario = 0;
        let gameContainer = document.getElementById('game');

        function loadScenario(index) {
            if (index >= scenarios.length) {
                gameContainer.innerHTML = "<h2>Thank you for playing Collateral Dilemma!</h2>";
                return;
            }

            const scenario = scenarios[index];
            gameContainer.innerHTML = `
                <div class="progress">Scenario ${scenario.id} of ${scenarios.length}</div>
                <div class="scenario">
                    <h2>${scenario.title}</h2>
                    <p>${scenario.description}</p>
                    <div class="graphic" id="graphic">
                        ${scenario.graphic(null)}
                    </div>
                    <div class="options">
                        ${scenario.options.map((option, i) => `
                            <button class="option-button" onclick="selectOption(${i})">${option.text}</button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function selectOption(optionIndex) {
            const scenario = scenarios[currentScenario];
            const selectedOption = scenario.options[optionIndex];

            // Update stats (in a real application, you would send this to a server)
            selectedOption.stats[optionIndex === 0 ? 'A' : 'B'] += 1;

            // Display result with updated graphic
            gameContainer.innerHTML = `
                <div class="scenario">
                    <h2>${scenario.title}</h2>
                    <p>You chose: <strong>${selectedOption.text}</strong></p>
                    <div class="graphic" id="graphic">
                        ${scenario.graphic(optionIndex)}
                    </div>
                    <div class="result">
                        <p>Thank you for your choice. Here's how others have responded:</p>
                        <div class="stats">
                            Option A: ${scenario.options[0].stats['A']} votes<br>
                            Option B: ${scenario.options[1].stats['B']} votes
                        </div>
                    </div>
                    <button class="option-button" onclick="nextScenario()">Next Scenario</button>
                </div>
            `;

            // Run animation
            scenario.animation(optionIndex);
        }

        function nextScenario() {
            currentScenario++;
            loadScenario(currentScenario);
        }

        function showSpeechBubble(x, y, text) {
            const bubble = document.createElement('div');
            bubble.className = 'speech-bubble';
            bubble.style.left = `${x}px`;
            bubble.style.top = `${y}px`;
            bubble.innerText = text;
            document.getElementById('graphic').appendChild(bubble);
            bubble.style.display = 'block';
        }

        // Start the game
        loadScenario(currentScenario);
    </script>
</body>
</html>
